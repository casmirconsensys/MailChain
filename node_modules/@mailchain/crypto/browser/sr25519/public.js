import { cryptoWaitReady, sr25519Verify } from '@polkadot/util-crypto';
import { KindSR25519 } from '../keys.js';

const SR25519PublicKeyLen = 32;
class SR25519PublicKey {
    constructor(bytes) {
        Object.defineProperty(this, "bytes", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "curve", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: KindSR25519
        });
        if (bytes.length !== SR25519PublicKeyLen) {
            throw new RangeError('invalid public key length');
        }
        this.bytes = bytes;
    }
    async verify(message, sig) {
        const ready = await cryptoWaitReady(); // needed before calling sr25519Sign
        if (!ready) {
            throw new Error('crypto libraries could not be initialized');
        }
        return sr25519Verify(message, sig, this.bytes);
    }
}

export { SR25519PublicKey, SR25519PublicKeyLen };
