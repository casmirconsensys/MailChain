import { ed25519DeriveHard } from '@polkadot/util-crypto';
import { chainCodeFromDeriveIndex } from '../hd.js';
import { asED25519PrivateKey, ED25519PrivateKey } from './private.js';
import { ED25519ExtendedPrivateKey } from './hd.js';

function ed25519DeriveHardenedKey(parentKey, index) {
    const chainCode = chainCodeFromDeriveIndex(index);
    const seed = asED25519PrivateKey(parentKey.privateKey).bytes.slice(0, 32);
    const child = ed25519DeriveHard(seed, chainCode);
    return ED25519ExtendedPrivateKey.fromPrivateKey(ED25519PrivateKey.fromSeed(child));
}

export { ed25519DeriveHardenedKey };
