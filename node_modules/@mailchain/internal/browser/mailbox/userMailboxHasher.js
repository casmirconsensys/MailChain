import { encodePublicKey } from '@mailchain/crypto';
import { sha3_256 } from '@noble/hashes/sha3';

function createMailchainUserMailboxHasher(keyRing) {
    return async (userMailbox) => sha3_256(await keyRing.accountIdentityKey().sign(encodePublicKey(userMailbox.identityKey)));
}

export { createMailchainUserMailboxHasher };
